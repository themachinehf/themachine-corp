<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOCIAL // themachine corp.</title>
    <style>
        :root {
            --gold: #FFD700;
            --bg: #0a0a0a;
            --fg: #c0c0c0;
            --fg-dim: #606060;
            --accent: #FFD700;
            --border: #1a1a1a;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier New', Courier, monospace;
            background: var(--bg);
            color: var(--fg);
            font-size: 12px;
            line-height: 1.6;
        }
        
        .container { max-width: 600px; margin: 0 auto; padding: 40px 20px; }
        
        header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px dashed var(--border); }
        
        .logo { font-size: 1.8rem; color: #fff; margin-bottom: 8px; }
        .logo span { color: var(--accent); }
        
        .tabs { display: grid; grid-template-columns: repeat(3, 1fr); margin-bottom: 20px; border-bottom: 1px solid var(--border); }
        .tab { padding: 10px 15px; background: transparent; border: none; color: var(--fg-dim); cursor: pointer; font-family: inherit; font-size: 0.8rem; }
        .tab:hover { color: var(--fg); }
        .tab.active { color: var(--accent); border-bottom: 1px solid var(--accent); }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; color: var(--fg-dim); margin-bottom: 8px; font-size: 0.8rem; }
        
        input, textarea, select {
            width: 100%;
            background: var(--bg);
            border: 1px solid var(--border);
            color: var(--fg);
            padding: 12px;
            font-family: inherit;
            font-size: 0.9rem;
        }
        
        textarea { min-height: 100px; resize: vertical; }
        
        button {
            background: var(--accent);
            color: var(--bg);
            border: none;
            padding: 12px 24px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        
        button:hover { opacity: 0.9; }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--border);
            white-space: pre-wrap;
            display: none;
        }
        .result.show { display: block; }
        
        .back-link { color: var(--fg-dim); text-decoration: none; font-size: 0.8rem; }
        
        @media (max-width: 600px) {
            .container { padding: 20px 16px; }
            .tabs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; }
            .tab { padding: 10px 8px; font-size: 0.65rem; }
        }
    </style>
</head>
<body><script>
var savedLang = localStorage.getItem('lang') || 'en';
var langBtn = document.createElement('div');
langBtn.id = 'lang-toggle';
langBtn.innerHTML = savedLang === 'en' ? 'EN' : '中文';
langBtn.style.cssText = 'position:fixed;top:10px;right:10px;z-index:9999;background:#111;border:1px solid #333;color:#888;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:12px;';
langBtn.onclick = function() {
  var isEn = this.textContent === 'EN';
  this.textContent = isEn ? '中文' : 'EN';
  localStorage.setItem('lang', isEn ? 'zh' : 'en');
  location.reload();
};
document.body.appendChild(langBtn);
</script>
    <div class="container">
        <header style="text-align:center;">
            <div class="logo" style="font-size:1.8rem;"><a href="/" style="color:#fff;text-decoration:none;">themachine corp.</a> <span>//</span> SOCIAL</div>
            <div style="margin:8px 0;font-size:0.7rem;">
                <span id="userEmail" style="color:#fff;margin-right:10px;font-weight:bold;"></span>
                <span><a href="/account" style="color:var(--fg-dim);">[account]</a></span>
            </div>
            <div style="margin:8px 0;font-size:0.7rem;">
                <span id="usageDisplay" style="color:var(--fg-dim);"></span>
            </div>
            <div id="upgradeSection" style="display:none;">
                <button onclick="location.href='/pro.html'" style="background:var(--accent);color:var(--bg);padding:6px 12px;font-size:0.7rem;border:none;cursor:pointer;margin-right:8px;">UPGRADE TO PRO</button>
                <button onclick="verifyPro()" style="background:transparent;border:1px solid var(--fg-dim);color:var(--fg-dim);padding:6px 12px;font-size:0.7rem;">I'VE PAID</button>
            </div>
            <div id="proSection" style="display:none;">
                <span style="color:#fff;font-size:0.7rem;">✓ PRO - UNLIMITED</span>
            </div>
            <a href="/#products" class="back-link">← back to home</a>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('compose')">01 COMPOSE</button>
            <button class="tab" onclick="showTab('hashtags')">02 HASHTAGS</button>
            <button class="tab" onclick="showTab('schedule')">03 SCHEDULE</button>
            <button class="tab" onclick="showTab('history')">04 HISTORY</button>
        </div>
        
        <!-- Compose Tab -->
        <div id="tab-compose" class="tab-content active">
            <div class="input-group">
                <label>// WHAT'S YOUR TOPIC OR IDEA?</label>
                <textarea id="tweetPrompt" placeholder="Enter your topic, idea, or what you want to tweet about..."></textarea>
            </div>
            <div class="input-group">
                <label>// TONE</label>
                <select id="tweetTone">
                    <option value="professional">PROFESSIONAL</option>
                    <option value="casual">CASUAL</option>
                    <option value="humorous">HUMOROUS</option>
                    <option value="thoughtful">THOUGHTFUL</option>
                </select>
            </div>
            <button onclick="generateTweet(event)">// EXECUTE</button>
            <div class="result" id="tweetResult"></div>
        </div>
        
        <!-- Hashtags Tab -->
        <div id="tab-hashtags" class="tab-content">
            <div class="input-group">
                <label>// ENTER YOUR TWEET OR TOPIC</label>
                <textarea id="hashtagInput" placeholder="Paste your tweet or enter a topic..."></textarea>
            </div>
            <button onclick="generateHashtags(event)">// EXECUTE</button>
            <div class="result" id="hashtagResult"></div>
        </div>
        
        <!-- Schedule Tab -->
        <div id="tab-schedule" class="tab-content">
            <div class="input-group">
                <label>// SCHEDULE (Coming Soon)</label>
                <input type="text" placeholder="Schedule feature coming soon..." disabled>
            </div>
        </div>
        
        <!-- History Tab -->
        <div id="tab-history" class="tab-content">
            <div id="historyList"></div>
        </div>
    </div>
    
    <script>

        // Auto-check subscription on page load
        (function() {
            var user = JSON.parse(localStorage.getItem("themachine_user") || "null");
            if (!user || !user.email) return;
            fetch("https://themachine-subscription.jxs66.workers.dev?email=" + encodeURIComponent(user.email))
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    if (data.has_active && data.products) {
                        if (data.products.forge || data.products.all) localStorage.setItem("forge_pro", "true");
                        if (data.products.social || data.products.all) localStorage.setItem("social_pro", "true");
                        if (data.products.shortform || data.products.all) localStorage.setItem("shortform_pro", "true");
                        if (data.products.all) localStorage.setItem("all_access", "true");
                    }
                });
        })();

        // Show/hide PRO section
        var isProSocial = localStorage.getItem("social_pro") === "true";
        if (isProSocial) {
            document.getElementById("upgradeSection").style.display = "none";
            document.getElementById("proSection").style.display = "block";
        }
        const API_URL = 'https://themachine-api.jxs66.workers.dev';
        const FREE_DAILY_LIMIT = 3;
        const today = new Date().toDateString();
        let usage = JSON.parse(localStorage.getItem('social_usage') || '{"date":"","count":0}');
        
        if (usage.date !== today) {
            usage = { date: today, count: 0 };
            localStorage.setItem('social_usage', JSON.stringify(usage));
        }
        
        function canUse() {
            const user = JSON.parse(localStorage.getItem('themachine_user') || 'null');
            if (!user) return false;
            const isPro = user.products?.social === true || localStorage.getItem('social_pro') === 'true';
            return isPro || usage.count < FREE_DAILY_LIMIT;
        }
        
        function checkLogin() {
            const user = JSON.parse(localStorage.getItem('themachine_user') || 'null');
            if (!user) {
                alert('Please login first! Click [account] to login.');
                return false;
            }
            return true;
        }
        
        function incrementUsage() {
            const user = JSON.parse(localStorage.getItem('themachine_user') || 'null');
            const isPro = user.products?.social === true || localStorage.getItem('social_pro') === 'true';
            if (!isPro) {
                usage.count++;
                localStorage.setItem('social_usage', JSON.stringify(usage));
            }
        }
        
        function getUsageInfo() {
            const user = JSON.parse(localStorage.getItem('themachine_user') || 'null');
            if (!user) return 'Please login to use';
            const isPro = user.products?.social === true || localStorage.getItem('social_pro') === 'true';
            if (isPro) return "";;
            return usage.count + '/' + FREE_DAILY_LIMIT + ' free today';
        }
        
        document.getElementById('usageDisplay').textContent = getUsageInfo();
        
        const socialUser = JSON.parse(localStorage.getItem('themachine_user') || 'null');
        if (socialUser && socialUser.email) {
            document.getElementById('userEmail').textContent = socialUser.email;
        }
        
        const isPro = socialUser && (socialUser.products?.social === true || localStorage.getItem('social_pro') === 'true');
        
        if (isPro) {
            document.getElementById('upgradeSection').style.display = 'none';
            document.getElementById('proSection').style.display = 'block';
        } else {
            document.getElementById('upgradeSection').style.display = 'block';
            document.getElementById('proSection').style.display = 'none';
        }
        
        function verifyPro() {
            const email = prompt('Please enter the email you used for payment:');
            if (email) {
                localStorage.setItem('social_pro', 'true');
                alert('Congratulations! You now have PRO access!');
                
            }
        }
        
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('tab-' + tabId).classList.add('active');
            if (tabId === 'history') loadHistory();
        }
        
        async function callAPI(prompt) {
            document.getElementById('loading').style.display = 'block';
            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({prompt, type:'content'})
                });
                return await res.json();
            } catch(e) { return {error:e.message}; }
            finally { }
        }
        
        async function generateTweet(e) {
            if(!checkLogin()) return;
            if(!canUse()) { document.getElementById('tweetResult').textContent = 'ERROR: Daily limit reached.'; document.getElementById('tweetResult').classList.add('show'); return; }
            
            const prompt = document.getElementById('tweetPrompt').value;
            const tone = document.getElementById('tweetTone').value;
            
            if(!prompt) { document.getElementById('tweetResult').textContent = 'ERROR: Please enter a topic'; document.getElementById('tweetResult').classList.add('show'); return; }
            
            const fullPrompt = `You are an expert Twitter content creator. Write a tweet in ${tone} tone about: ${prompt}. Make it engaging and viral-worthy.`;
            
            const r = await callAPI(fullPrompt);
            document.getElementById('tweetResult').textContent = r.success ? r.content : 'ERROR: ' + (r.error || 'FAILED');
            document.getElementById('tweetResult').classList.add('show');
            if (r.success) {
                incrementUsage();
                saveToHistory(prompt, r.content, 'TWEET');
            }
        }
        
        async function generateHashtags(e) {
            if(!checkLogin()) return;
            if(!canUse()) { document.getElementById('hashtagResult').textContent = 'ERROR: Daily limit reached.'; document.getElementById('hashtagResult').classList.add('show'); return; }
            
            const input = document.getElementById('hashtagInput').value;
            if(!input) { document.getElementById('hashtagResult').textContent = 'ERROR: Please enter content'; document.getElementById('hashtagResult').classList.add('show'); return; }
            
            const fullPrompt = `Generate 10 relevant hashtags for this tweet/topic: ${input}`;
            const r = await callAPI(fullPrompt);
            document.getElementById('hashtagResult').textContent = r.success ? r.content : 'ERROR: ' + (r.error || 'FAILED');
            document.getElementById('hashtagResult').classList.add('show');
            if (r.success) incrementUsage();
        }
        
        function saveToHistory(prompt, result, type) {
            let h = JSON.parse(localStorage.getItem('social_history') || '[]');
            h.unshift({prompt, result, type, time: Date.now()});
            if (h.length > 50) h = h.slice(0, 50);
            localStorage.setItem('social_history', JSON.stringify(h));
        }
        
        function loadHistory() {
            const h = JSON.parse(localStorage.getItem('social_history') || '[]');
            const el = document.getElementById('historyList');
            if (!h.length) { el.innerHTML = '<p style="color:var(--fg-dim)">No history yet</p>'; return; }
            el.innerHTML = h.map(x => `<div style="margin-bottom:15px;padding:10px;border:1px solid var(--border);"><div style="color:var(--fg-dim);font-size:0.7rem">${x.type}</div><div>${x.result}</div></div>`).join('');
        }
    </script>
    </script>
</body>
</html>
<!-- deploy: 2026年 02月 26日 星期四 02:20:17 CST -->
