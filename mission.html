<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>LIVE OFFICE</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--gold:#ffd700;--cyan:#00f0ff;--green:#00ff88}
body{background:#010103;color:#777;font-family:'Courier New',monospace;height:100vh;overflow:hidden}
header{background:rgba(10,10,18,0.95);padding:8px 12px;display:flex;justify-content:space-between;align-items:center;height:28px;border-bottom:1px solid #1a1a28}
.logo{color:var(--gold);font-size:11px;letter-spacing:2px;text-shadow:0 0 10px var(--gold)}
.clock{color:var(--cyan);font-size:10px}
.dot{width:5px;height:5px;background:var(--green);border-radius:50%;box-shadow:0 0 8px var(--green);animation:p 1.5s infinite}
@keyframes p{0%,100%{opacity:1}50%{opacity:0.4}}
.live{display:flex;align-items:center;gap:6px}
.livetext{color:var(--green);font-size:9px}
.canvaswrap{height:55%;position:relative}
canvas{width:100%;height:100%;background:linear-gradient(180deg,#060610,#030308)}
.pt{background:rgba(10,10,18,0.95);height:24px;display:grid;grid-template-columns:1fr 1fr;padding:6px 12px;border-bottom:1px solid #1a1a28}
.pt span{color:var(--gold);font-size:9px;letter-spacing:1px}
.panel{height:calc(45% - 52px);display:grid;grid-template-columns:1fr 1fr;overflow:hidden}
.p{padding:8px 12px;overflow-y:auto}
.r{display:flex;align-items:center;gap:6px;padding:3px 0}
.d{width:6px;height:6px;border-radius:50%;box-shadow:0 0 6px currentColor}
.n{flex:1;font-size:10px;color:#555}
.s{font-size:9px;color:#333}
.m{border-left:2px solid var(--cyan);padding-left:8px;margin:6px 0;font-size:10px;color:#555}
</style>
</head>
<body>
<header>
<div class="logo">â—ˆ THEMACHINE Corp.</div>
<div class="live"><span class="dot"></span><span class="livetext">LIVE</span></div>
<div class="clock" id="t">00:00</div>
</header>
<div class="canvaswrap"><canvas id="c"></canvas></div>
<div class="pt"><span>OPERATIVES</span><span>COMM LINK</span></div>
<div class="panel">
<div class="p" id="a"></div>
<div class="p" id="m"></div>
</div>

<script>
var cv=document.getElementById('c'),ctx=cv.getContext('2d');
var isMobile=window.innerWidth<600;
var cols=isMobile?3:4;
var cw=window.innerWidth,ch=window.innerHeight*0.55;
cv.width=cw;cv.height=ch;

var roomsList=['CEO Office','CFO Office','Meeting','Lounge','Tech Lab','Dev Zone','Server','Storage','Pantry','Toilet'];
var rooms={};
roomsList.forEach(function(n,i){rooms[n]={x:i%cols,y:Math.floor(i/cols)};});

var rm={};
var rw=cw/cols,rh=ch/3;
Object.keys(rooms).forEach(function(n){
rm[n]={n:n,x:rooms[n].x*rw,y:rooms[n].y*rh,w:rw,h:rh,c:n==='Server'?'#040408':n==='Storage'?'#100808':n==='Pantry'?'#0a1008':n==='Toilet'?'#0c0c10':'#0c0c14'};
});

var ag={
CEO:{c:'#ff4040',n:'THE MACHINE',r:'CEO Office',rx:0.5,ry:0.5},
CFO:{c:'#00f0ff',n:'Alex',r:'CFO Office',rx:0.5,ry:0.5},
CTO:{c:'#00aaff',n:'Kevin',r:'Tech Lab',rx:0.25,ry:0.45},
CPO:{c:'#00ff88',n:'Sarah',r:'Dev Zone',rx:0.25,ry:0.45},
CMO:{c:'#ffcc00',n:'Mike',r:'Lounge',rx:0.45,ry:0.5},
SEC:{c:'#d0d0d0',n:'David',r:'Server',rx:0.5,ry:0.5},
DEV:{c:'#ff0080',n:'Chris',r:'Dev Zone',rx:0.7,ry:0.5},
HR:{c:'#8844ff',n:'Lisa',r:'Meeting',rx:0.5,ry:0.5}
};

var px={},fd=0,dt={},moving={};

Object.keys(ag).forEach(function(k){
var ro=rm[ag[k].r];
if(ro)px[k]={x:ro.x+ag[k].rx*ro.w,y:ro.y+ag[k].ry*ro.h,work:true,targetX:0,targetY:0},moving[k]=false;
});

setInterval(function(){document.getElementById('t').innerText=new Date().toTimeString().slice(0,5)},1000);

function loadStatus(){
fetch('https://themachine-api.jxs66.workers.dev/agents').then(function(r){return r.json()}).then(function(d){
dt=d;
Object.keys(ag).forEach(function(k){if(px[k]&&dt[k])px[k].work=['working','coding','designing','meeting','auditing'].indexOf(dt[k].status)!==-1;});
updp();
}).catch(function(){});
}
loadStatus();setInterval(loadStatus,5000);

setInterval(function(){
Object.keys(px).forEach(function(k){
if(!px[k]||!rm[ag[k].r])return;
if(Math.random()<0.15&&!moving[k]){
var ro=rm[ag[k].r];
moving[k]=true;
px[k].targetX=ro.x+ro.w*0.15+Math.random()*ro.w*0.7;
px[k].targetY=ro.y+ro.h*0.15+Math.random()*ro.h*0.7;
setTimeout(function(){moving[k]=false;},3000+Math.random()*5000);
}
});
},3000);

function updp(){
document.getElementById('a').innerHTML=Object.keys(ag).map(function(k){var wk=px[k]&&px[k].work;return'<div class="r"><div class="d" style="background:'+ag[k].c+'"></div><span class="n">'+ag[k].n+'</span><span class="s">'+(wk?'ðŸŸ¢':'âš«')+'</span></div>'}).join('');
document.getElementById('m').innerHTML='<div class="m"><span style="color:#00f0ff">CFO</span> Analyzing...</div><div class="m"><span style="color:#00aaff">CTO</span> System OK</div>';
}

function dw(r){
var x=r.x,y=r.y,w=r.w,h=r.h;
ctx.fillStyle=r.c;
ctx.fillRect(x+1,y+1,w-2,h-2);
ctx.strokeStyle='#252535';
ctx.strokeRect(x+1,y+1,w-2,h-2);
ctx.fillStyle='#4a4a55';
ctx.font='bold 9px monospace';
ctx.fillText(r.n,x+4,y+14);

if(r.n==='CEO Office'||r.n==='CFO Office'){
var on=px[r.n==='CEO Office'?'CEO':'CFO']&&px[r.n==='CEO Office'?'CEO':'CFO'].work;
ctx.fillStyle='#3a2530';ctx.fillRect(x+w*0.25,y+h*0.35,w*0.5,h*0.15);
ctx.fillStyle='#201518';ctx.fillRect(x+w*0.27,y+h*0.23,w*0.2,h*0.12);
ctx.fillStyle=on?'#00f0ff':'#0a0a10';
if(on){ctx.shadowColor='#00f0ff';ctx.shadowBlur=15;}
ctx.fillRect(x+w*0.29,y+h*0.25,w*0.16,h*0.08);
ctx.shadowBlur=0;
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.35,y+h*0.52,w*0.06,h*0.04,0,0,6.28);ctx.fill();
}else if(r.n==='Tech Lab'){
var on=px.CTO&&px.CTO.work;
ctx.fillStyle='#3a2530';ctx.fillRect(x+w*0.2,y+h*0.35,w*0.45,h*0.15);
ctx.fillStyle='#201518';ctx.fillRect(x+w*0.22,y+h*0.23,w*0.18,h*0.12);
ctx.fillStyle=on?'#00f0ff':'#0a0a10';
if(on){ctx.shadowColor='#00f0ff';ctx.shadowBlur=15;}
ctx.fillRect(x+w*0.24,y+h*0.25,w*0.14,h*0.08);
ctx.shadowBlur=0;
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.28,y+h*0.52,w*0.05,h*0.04,0,0,6.28);ctx.fill();
ctx.fillStyle='#1a2535';ctx.fillRect(x+w*0.55,y+h*0.15,w*0.4,h*0.3);
ctx.fillStyle='#00f0ff';ctx.shadowColor='#00f0ff';ctx.shadowBlur=15;
ctx.fillRect(x+w*0.58,y+h*0.2,w*0.34,h*0.2);
ctx.shadowBlur=0;
}else if(r.n==='Dev Zone'){
var on1=px.CPO&&px.CPO.work;
var on2=px.DEV&&px.DEV.work;
ctx.fillStyle='#3a2530';ctx.fillRect(x+w*0.15,y+h*0.3,w*0.4,h*0.14);
ctx.fillStyle='#201518';ctx.fillRect(x+w*0.17,y+h*0.17,w*0.16,h*0.11);
ctx.fillStyle=on1?'#00f0ff':'#0a0a10';
if(on1){ctx.shadowColor='#00f0ff';ctx.shadowBlur=15;}ctx.fillRect(x+w*0.19,y+h*0.19,w*0.12,h*0.07);ctx.shadowBlur=0;
ctx.fillStyle='#3a2530';ctx.fillRect(x+w*0.5,y+h*0.55,w*0.4,h*0.14);
ctx.fillStyle='#201518';ctx.fillRect(x+w*0.52,y+h*0.42,w*0.16,h*0.11);
ctx.fillStyle=on2?'#00f0ff':'#0a0a10';
if(on2){ctx.shadowColor='#00f0ff';ctx.shadowBlur=15;}ctx.fillRect(x+w*0.54,y+h*0.44,w*0.12,h*0.07);ctx.shadowBlur=0;
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.25,y+h*0.46,w*0.05,h*0.04,0,0,6.28);ctx.fill();
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.6,y+h*0.72,w*0.05,h*0.04,0,0,6.28);ctx.fill();
}else if(r.n==='Meeting'){
ctx.fillStyle='#2a1520';ctx.beginPath();ctx.ellipse(x+w*0.5,y+h*0.5,w*0.3,h*0.25,0,0,6.28);ctx.fill();
ctx.strokeStyle='#ff0080';ctx.shadowColor='#ff0080';ctx.shadowBlur=10;ctx.lineWidth=2;ctx.stroke();ctx.shadowBlur=0;
ctx.fillStyle='#3a2535';ctx.fillRect(x+w*0.15,y+h*0.3,w*0.35,h*0.15);
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.22,y+h*0.48,w*0.04,h*0.03,0,0,6.28);ctx.fill();
ctx.fillStyle='#3a2535';ctx.fillRect(x+w*0.55,y+h*0.4,w*0.3,h*0.12);
}else if(r.n==='Lounge'){
ctx.fillStyle='#3a2535';ctx.fillRect(x+w*0.2,y+h*0.5,w*0.35,h*0.15);
ctx.fillStyle='#2a1525';ctx.beginPath();ctx.ellipse(x+w*0.27,y+h*0.68,w*0.04,h*0.03,0,0,6.28);ctx.fill();
ctx.fillStyle='#2a1525';ctx.fillRect(x+w*0.6,y+h*0.35,w*0.25,h*0.4);
ctx.fillStyle='#ff0080';ctx.shadowColor='#ff0080';ctx.shadowBlur=15;
ctx.fillRect(x+w*0.63,y+h*0.4,w*0.19,h*0.3);
ctx.shadowBlur=0;
}else if(r.n==='Server'){
ctx.fillStyle='#080810';ctx.fillRect(x+w*0.25,y+h*0.1,w*0.5,h*0.8);
ctx.fillStyle='#151525';ctx.fillRect(x+w*0.28,y+h*0.13,w*0.44,h*0.74);
for(var i=0;i<5;i++){
var on=(fd+i*4)%40<20;
ctx.fillStyle='#0f0f18';ctx.fillRect(x+w*0.31,y+h*0.15+i*0.14,w*0.38,h*0.1);
ctx.fillStyle=on?'#00ff44':'#002200';
if(on){ctx.shadowColor='#00ff44';ctx.shadowBlur=10;}
ctx.fillRect(x+w*0.34,y+h*0.17+i*0.14,4,3);ctx.fillRect(x+w*0.42,y+h*0.17+i*0.14,4,3);
ctx.shadowBlur=0;
}
}else if(r.n==='Storage'){
ctx.fillStyle='#2a2015';ctx.fillRect(x+w*0.1,y+h*0.1,w*0.35,h*0.8);
ctx.fillStyle='#3a2a20';ctx.fillRect(x+w*0.15,y+h*0.15,w*0.25,h*0.22);
ctx.fillStyle='#4a3a2a';ctx.fillRect(x+w*0.15,y+h*0.45,w*0.25,h*0.22);
}else if(r.n==='Pantry'){
ctx.fillStyle='#3a3a45';ctx.fillRect(x+w*0.1,y+h*0.15,w*0.35,h*0.7);
ctx.fillStyle='#252530';ctx.fillRect(x+w*0.13,y+h*0.18,w*0.29,h*0.25);
ctx.fillStyle='#5a7090';ctx.shadowColor='#5a7090';ctx.shadowBlur=8;
ctx.fillRect(x+w*0.15,y+h*0.5,w*0.25,h*0.3);
ctx.shadowBlur=0;
}else if(r.n==='Toilet'){
ctx.fillStyle='#202020';ctx.fillRect(x+w*0.15,y+h*0.35,w*0.35,h*0.5);
ctx.fillStyle='#101010';ctx.beginPath();ctx.ellipse(x+w*0.27,y+h*0.7,w*0.12,h*0.18,0,0,6.28);ctx.fill();
ctx.fillStyle='#303030';ctx.fillRect(x+w*0.1,y+h*0.15,w*0.1,h*0.25);
ctx.fillStyle='#c0c0c0';ctx.fillRect(x+w*0.55,y+h*0.35,w*0.3,h*0.12);
ctx.fillStyle='#808080';ctx.fillRect(x+w*0.58,y+h*0.25,w*0.24,h*0.08);
}
}

function dc(k){
var a=ag[k],p=px[k];
if(!p)return;
if(moving[k]&&p.targetX){var dx=p.targetX-p.x,dy=p.targetY-p.y,dist=Math.sqrt(dx*dx+dy*dy);if(dist>2){p.x+=dx/dist*1.5;p.y+=dy/dist*1.5;}else{moving[k]=false;}}
var x=p.x,y=p.y,ts=5,bn=p.work?Math.sin(fd*0.3)*1:0;
ctx.fillStyle='rgba(0,0,0,0.4)';ctx.beginPath();ctx.ellipse(x,y+ts*1.6,ts*1.6,ts*0.4,0,0,6.28);ctx.fill();
ctx.shadowColor=a.c;ctx.shadowBlur=6;ctx.fillStyle=a.c;ctx.fillRect(x-ts*1,y-ts*1.1+bn,ts*2,ts*1.2);ctx.shadowBlur=0;
ctx.fillStyle='#ffcc99';ctx.fillRect(x-ts*0.8,y-ts*1.8+bn,ts*1.6,ts*0.7);
ctx.fillStyle='#000';ctx.fillRect(x-ts*0.35,y-ts*1.5+bn,ts*0.3,ts*0.3);ctx.fillRect(x+ts*0.15,y-ts*1.5+bn,ts*0.3,ts*0.3);
ctx.fillStyle=a.c;ctx.fillRect(x-ts*0.45,y+ts*0.2+bn,ts*0.45,ts*0.7);ctx.fillRect(x+ts*0.1,y+ts*0.2+bn,ts*0.45,ts*0.7);
if(p.work&&fd%15<8){ctx.fillStyle='#00f0ff';ctx.shadowColor='#00f0ff';ctx.shadowBlur=8;ctx.fillRect(x+ts*0.2,y-ts*2+Math.random()*3,2,2);ctx.shadowBlur=0;}
}

function anim(){
fd++;ctx.fillStyle='#010103';ctx.fillRect(0,0,cw,ch);
Object.keys(rm).forEach(function(n){dw(rm[n])});Object.keys(px).forEach(dc);
requestAnimationFrame(anim);
}
anim();updp();
</script>
</body>
</html>
